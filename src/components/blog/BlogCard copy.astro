---
import { Image } from 'astro:assets';
import type { CollectionEntry } from 'astro:content'; 

interface Props {
  post: CollectionEntry<'blog'>;
}

const { post } = Astro.props;


// ğŸŸ¢ é—œéµä¿®æ­£ï¼šAstro 5 ä½¿ç”¨ idï¼Œä¸”å› ç‚ºæˆ‘å€‘ç”¨äº† glob loaderï¼Œid æœƒåŒ…å«å‰¯æª”å
// æˆ‘å€‘éœ€è¦æŠŠ .mdoc / .md æ‹¿æ‰ï¼Œæ‰èƒ½å°æ‡‰åˆ° [...slug].astro çš„è·¯å¾‘
const slug = post.id.replace(/\.(mdoc|md|yaml|json)$/, '');
---

{/* ä¿®æ­£é€£çµï¼šåŸæœ¬å¯èƒ½æ˜¯ /blog/${post.slug} */}
<a href={`/blog/${slug}`} class="group block">
  
  <article class="bg-surface rounded-2xl overflow-hidden shadow-sm hover:shadow-md transition-shadow duration-300 border border-gray-100 h-full flex flex-col">
    
    {/* å°é¢åœ– */}
    <div class="aspect-video overflow-hidden bg-gray-200 relative">
      {post.data.coverImage ? (
        <Image 
          src={post.data.coverImage} 
          alt={post.data.title}
          class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"
        />
      ) : (
// ğŸŸ¢ [ä¿®æ”¹é€™è£¡] æ²’æœ‰åœ–ç‰‡æ™‚çš„æ›¿ä»£æ–¹æ¡ˆï¼šæ¨™é¡Œå¤§å­—å¡
        // ä½¿ç”¨å“ç‰Œè‰²çš„æ·¡æ¼¸å±¤èƒŒæ™¯ï¼Œæ­é… serif å¤§å­—é«”
        <div class="w-full h-full flex items-center justify-center p-8 bg-gradient-to-br from-primary/5 via-bg to-accent/10 group-hover:from-primary/10 group-hover:to-accent/20 transition-colors">
           <h3 class="text-2xl lg:text-3xl font-serif font-bold text-primary/80 text-center leading-tight line-clamp-4 group-hover:text-primary">
             {post.data.title}
           </h3>
        </div>
      )}
    </div>

    {/* å…§å®¹ */}
    <div class="p-6 flex-1 flex flex-col">
      {/* æ¨™ç±¤ */}
      <div class="flex flex-wrap gap-2 mb-3">
        {(post.data.tags || []).slice(0, 2).map(tag => (
          <span class="text-xs font-bold text-accent px-2 py-1 bg-highlight-gold rounded-md">
            #{tag}
          </span>
        ))}
      </div>

      <h3 class="text-xl font-serif font-bold text-primary mb-3 group-hover:text-accent transition-colors line-clamp-2">
        {post.data.title}
      </h3>

      {/* æ‘˜è¦ (å„ªå…ˆä½¿ç”¨ advanced.excerpt > seoDescription > title) */}
      <p class="text-text/80 text-sm line-clamp-3 mb-4 flex-1">
        {
          post.data.advanced?.discriminant 
            ? (post.data.advanced.value.excerpt || post.data.advanced.value.seoDescription)
            : post.data.title
        }
      </p>

      <div class="flex items-center justify-between text-xs text-text/50 mt-auto pt-4 border-t border-gray-100">
        <span>{post.data.date.toISOString().split('T')[0]}</span>
        <span class="group-hover:translate-x-1 transition-transform text-primary font-medium">é–±è®€æ›´å¤š â†’</span>
      </div>
    </div>
  </article>
</a>