---
import MobileMenu from './MobileMenu.jsx';
import SearchWidget from './SearchWidget.jsx'; // ğŸŸ¢ æ”¹ç”¨æ–°å…ƒä»¶

const menuItems = [
  { label: 'é—œæ–¼é†«å¸«', href: '/#about' },
  { label: 'æœ€æ–°æ¶ˆæ¯', href: '/news' },
  { label: 'ä¸»æ²»å°ˆé•·', href: '/#expertise' },
  { label: 'å½±éŸ³å°ˆå€', href: '/video' },
  { label: 'è¡›æ•™å°ˆæ¬„', href: '/blog' },
  { label: 'é–€è¨ºè³‡è¨Š', href: '/#clinic' },
];
---

<link href="/pagefind/pagefind-ui.css" rel="stylesheet">
<script src="/pagefind/pagefind-ui.js" is:inline></script>

<header class="fixed top-0 w-full z-40 bg-bg/85 backdrop-blur-md border-b border-white/20 shadow-sm transition-all duration-300">
  <div class="container mx-auto px-4 md:px-6 h-20 flex justify-between items-center relative">
    
    {/* 1. Logo å€åŸŸ */}
    <a href="/" class="group flex flex-col justify-center items-start shrink-0">
      <span class="font-serif text-2xl font-bold text-primary tracking-wide leading-none group-hover:text-accent transition-colors">
        Dr. Chou
      </span>
      <span class="text-[0.6rem] font-bold text-accent tracking-[0.2em] uppercase mt-1">
        Urology Clinic
      </span>
    </a>

    {/* 2. æ¡Œæ©Ÿç‰ˆå°è¦½åˆ— + æœå°‹ (Desktop Nav) */}
    {/* ä½¿ç”¨ lg:flex éš±è—ä¸­å‹å¹³æ¿ä»¥ä¸‹çš„é¸å–®ï¼Œé¿å…å¤ªæ“  */}
    <div class="hidden lg:flex items-center gap-6 xl:gap-8 flex-1 justify-end">
      <nav class="flex items-center gap-5 xl:gap-7">
        {menuItems.map(item => (
          <a 
            href={item.href} 
            class="text-sm font-medium text-text hover:text-primary transition-colors relative group py-2 whitespace-nowrap"
          >
            {item.label}
            <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-accent transition-all duration-300 group-hover:w-full"></span>
          </a>
        ))}
      </nav>

      {/* åˆ†éš”ç·š */}
      <div class="h-4 w-px bg-gray-300/50"></div>

      {/* æœå°‹ widget (æ¡Œæ©Ÿç‰ˆæœƒç›´æ¥é¡¯ç¤º input) */}
      <SearchWidget client:idle />

      {/* CTA æŒ‰éˆ• */}
      <a 
        href="/#clinic" 
        class="px-5 py-2.5 bg-primary text-white text-sm font-bold rounded-full hover:bg-accent hover:-translate-y-0.5 shadow-md shadow-primary/20 transition-all duration-300 shrink-0"
      >
        é ç´„æ›è™Ÿ
      </a>
    </div>

    {/* 3. æ‰‹æ©Ÿç‰ˆ/å¹³æ¿ç‰ˆ (Mobile/Tablet) */}
    <div class="flex items-center gap-2 lg:hidden">
      {/* æœå°‹ widget (æ‰‹æ©Ÿç‰ˆæœƒé¡¯ç¤ºæ”¾å¤§é¡) */}
      <SearchWidget client:idle />
      
      {/* æ¼¢å ¡é¸å–® */}
      <MobileMenu client:media="(max-width: 1024px)" menuItems={menuItems} />
    </div>

  </div>
</header>

<style is:global>
  /* === Pagefind UI å…±ç”¨è¨­å®š === */
  /* é€™è£¡ä½¿ç”¨ theme() å‡½æ•¸ç›´æ¥æŠ“å– tailwind.config.mjs çš„è¨­å®š */
  :root {
    --pagefind-ui-scale: 0.8;
    --pagefind-ui-primary: theme('colors.primary'); /* è‡ªå‹•å°æ‡‰ #2A8BC8 */
    --pagefind-ui-text: theme('colors.text');       /* è‡ªå‹•å°æ‡‰ #334155 */
    --pagefind-ui-background: theme('colors.surface'); /* è‡ªå‹•å°æ‡‰ #FFFFFF */
    --pagefind-ui-border: theme('colors.gray.300');    /* å°æ‡‰é è¨­ Tailwind Gray */
    --pagefind-ui-border-radius: 9999px;
  }

  /* éš±è—ç¸®åœ–èˆ‡æ¸…é™¤æŒ‰éˆ• */
  .pagefind-ui__result-thumb,
  .pagefind-ui__search-clear {
    @apply hidden !important;
  }

  /* === æ¡Œæ©Ÿç‰ˆæ¨£å¼ä¿®æ­£ (#desktop-search) === */
  
  /* æœå°‹æ¡†æœ¬é«” */
  #desktop-search .pagefind-ui__search-input {
    @apply bg-gray-50 border border-gray-300 text-sm text-text rounded-full w-full !important;
    /* Tailwind çš„ opacity-100 èˆ‡ visible */
    @apply opacity-100 visible !important; 
    
    height: 40px !important;
    padding-left: 2.5rem !important;
    padding-right: 1rem !important;
  }
  
  /* æœå°‹æ¡† Focus ç‹€æ…‹ */
  #desktop-search .pagefind-ui__search-input:focus {
    @apply bg-surface border-primary outline-none !important;
    /* é€™è£¡ä½¿ç”¨ rgba æ‰‹å‹•è¨­å®šé™°å½±ï¼Œå› ç‚ºè¦é…åˆä¸»è‰²é€æ˜åº¦ */
    box-shadow: 0 0 0 3px color-mix(in srgb, theme('colors.primary'), transparent 90%) !important;
  }

  /* æœå°‹ Icon ä½ç½® */
  #desktop-search .pagefind-ui__search-input::before {
    @apply top-1/2 -translate-y-1/2 !important;
  }

  /* æœå°‹çµæœä¸‹æ‹‰é¸å–® (Desktop) */
  #desktop-search .pagefind-ui__drawer {
    @apply absolute right-0 w-[320px] bg-surface rounded-xl border border-gray-200 shadow-xl overflow-y-auto !important;
    top: 110%;
    max-height: 400px;
    z-index: 60;
    padding: 0;
  }

  /* === æ‰‹æ©Ÿç‰ˆæ¨£å¼ä¿®æ­£ (#mobile-search) === */
  #mobile-search .pagefind-ui__search-input {
    @apply border border-gray-300 text-base rounded-xl w-full bg-surface !important;
    padding: 1rem 1rem 1rem 3rem !important;
  }

  #mobile-search .pagefind-ui__drawer {
    @apply border-t border-gray-100 mt-4;
  }

  /* === çµæœåˆ—è¡¨é€šç”¨å„ªåŒ– === */
  .pagefind-ui__result {
    @apply border-b border-gray-100 !important;
    padding: 12px 16px !important;
  }
  
  .pagefind-ui__result:last-child {
    @apply border-none !important;
  }

  .pagefind-ui__result-title {
    @apply font-serif font-bold text-[0.95rem] text-primary !important;
  }
  
  /* ä¿®æ­£é€£çµæ¨£å¼ï¼Œå»é™¤é è¨­åº•ç·š */
  .pagefind-ui__result-link {
    @apply no-underline hover:text-accent transition-colors !important;
  }
  
  .pagefind-ui__message {
    @apply p-4 text-gray-500 text-center !important;
  }
</style>