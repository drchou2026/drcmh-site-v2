---
import MobileMenu from './MobileMenu.jsx';
import SearchWidget from './SearchWidget.jsx'; // ğŸŸ¢ æ”¹ç”¨æ–°å…ƒä»¶

const menuItems = [
  { label: 'é—œæ–¼é†«å¸«', href: '/#about' },
  { label: 'æœ€æ–°æ¶ˆæ¯', href: '/news' },
  { label: 'ä¸»æ²»å°ˆé•·', href: '/#expertise' },
  { label: 'å½±éŸ³å°ˆå€', href: '/video' },
  { label: 'è¡›æ•™å°ˆæ¬„', href: '/blog' },
  { label: 'é–€è¨ºè³‡è¨Š', href: '/#clinic' },
];
---

<link href="/pagefind/pagefind-ui.css" rel="stylesheet">
<script src="/pagefind/pagefind-ui.js" is:inline></script>

<header class="fixed top-0 w-full z-40 bg-bg/85 backdrop-blur-md border-b border-white/20 shadow-sm transition-all duration-300">
  <div class="container mx-auto px-4 md:px-6 h-20 flex justify-between items-center relative">
    
    {/* 1. Logo å€åŸŸ */}
    <a href="/" class="group flex flex-col justify-center items-start shrink-0">
      <span class="font-serif text-2xl font-bold text-primary tracking-wide leading-none group-hover:text-accent transition-colors">
        Dr. Chou
      </span>
      <span class="text-[0.6rem] font-bold text-accent tracking-[0.2em] uppercase mt-1">
        Urology Clinic
      </span>
    </a>

    {/* 2. æ¡Œæ©Ÿç‰ˆå°è¦½åˆ— + æœå°‹ (Desktop Nav) */}
    {/* ä½¿ç”¨ lg:flex éš±è—ä¸­å‹å¹³æ¿ä»¥ä¸‹çš„é¸å–®ï¼Œé¿å…å¤ªæ“  */}
    <div class="hidden lg:flex items-center gap-6 xl:gap-8 flex-1 justify-end">
      <nav class="flex items-center gap-5 xl:gap-7">
        {menuItems.map(item => (
          <a 
            href={item.href} 
            class="text-sm font-medium text-text hover:text-primary transition-colors relative group py-2 whitespace-nowrap"
          >
            {item.label}
            <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-accent transition-all duration-300 group-hover:w-full"></span>
          </a>
        ))}
      </nav>

      {/* åˆ†éš”ç·š */}
      <div class="h-4 w-px bg-gray-300/50"></div>

      {/* æœå°‹ widget (æ¡Œæ©Ÿç‰ˆæœƒç›´æ¥é¡¯ç¤º input) */}
      <SearchWidget client:idle />

      {/* CTA æŒ‰éˆ• */}
      <a 
        href="/#clinic" 
        class="px-5 py-2.5 bg-primary text-white text-sm font-bold rounded-full hover:bg-accent hover:-translate-y-0.5 shadow-md shadow-primary/20 transition-all duration-300 shrink-0"
      >
        é ç´„æ›è™Ÿ
      </a>
    </div>

    {/* 3. æ‰‹æ©Ÿç‰ˆ/å¹³æ¿ç‰ˆ (Mobile/Tablet) */}
    <div class="flex items-center gap-2 lg:hidden">
      {/* æœå°‹ widget (æ‰‹æ©Ÿç‰ˆæœƒé¡¯ç¤ºæ”¾å¤§é¡) */}
      <SearchWidget client:idle />
      
      {/* æ¼¢å ¡é¸å–® */}
      <MobileMenu client:media="(max-width: 1024px)" menuItems={menuItems} />
    </div>

  </div>
</header>

<style is:global>
  /* === Pagefind UI å…±ç”¨è¨­å®š === */
  :root {
    --pagefind-ui-scale: 0.8;
    --pagefind-ui-primary: #2A8BC8;
    --pagefind-ui-text: #334155;
    --pagefind-ui-background: #ffffff;
    --pagefind-ui-border: #cbd5e1; /* åŠ æ·±é‚Šæ¡†é¡è‰² */
    --pagefind-ui-border-radius: 9999px;
  }

  .pagefind-ui__result-thumb,
  .pagefind-ui__search-clear {
    display: none !important;
  }

  /* === æ¡Œæ©Ÿç‰ˆæ¨£å¼ä¿®æ­£ (#desktop-search) === */
  /* ä¿®æ­£ï¼šå¼·åˆ¶çµ¦ Input èƒŒæ™¯è‰²èˆ‡é‚Šæ¡†ï¼Œé¿å…ã€Œæ¶ˆå¤±ã€ */
  #desktop-search .pagefind-ui__search-input {
    background-color: #f8fafc !important; /* æ·ºç°èƒŒæ™¯ */
    border: 1px solid #e2e8f0 !important;
    padding-left: 2.5rem !important;
    padding-right: 1rem !important;
    height: 40px !important; /* å›ºå®šé«˜åº¦ */
    font-size: 0.875rem !important;
    border-radius: 9999px !important;
    color: #334155 !important;
    width: 100% !important;
    opacity: 1 !important; /* ç¢ºä¿ä¸é€æ˜ */
    visibility: visible !important;
  }
  
  #desktop-search .pagefind-ui__search-input:focus {
    background-color: #ffffff !important;
    border-color: var(--pagefind-ui-primary) !important;
    box-shadow: 0 0 0 3px rgba(42, 139, 200, 0.1);
    outline: none;
  }

  /* æœå°‹ Icon ä½ç½®ä¿®æ­£ */
  #desktop-search .pagefind-ui__search-input::before {
    top: 50% !important;
    transform: translateY(-50%) !important;
  }

  /* æœå°‹çµæœé¸å–® (Desktop) */
  #desktop-search .pagefind-ui__drawer {
    position: absolute;
    top: 110%; /* ç¨å¾®å¾€ä¸‹æ¨ */
    right: 0;
    width: 320px;
    background: white;
    border-radius: 12px;
    box-shadow: 0 10px 30px -5px rgba(0, 0, 0, 0.15);
    border: 1px solid #e2e8f0;
    padding: 0;
    max-height: 400px;
    overflow-y: auto;
    z-index: 60;
  }

  /* === æ‰‹æ©Ÿç‰ˆæ¨£å¼ä¿®æ­£ (#mobile-search) === */
  #mobile-search .pagefind-ui__search-input {
    border: 1px solid #cbd5e1 !important;
    padding: 1rem 1rem 1rem 3rem !important;
    font-size: 1rem !important;
    border-radius: 12px !important;
    width: 100% !important;
    background-color: #ffffff !important;
  }

  #mobile-search .pagefind-ui__drawer {
    border-top: 1px solid #f1f5f9;
    margin-top: 1rem;
  }

  /* çµæœåˆ—è¡¨å„ªåŒ– */
  .pagefind-ui__result {
    padding: 12px 16px !important;
    border-bottom: 1px solid #f1f5f9 !important;
  }
  
  .pagefind-ui__result:last-child {
    border-bottom: none !important;
  }

  .pagefind-ui__result-title {
    font-family: 'Noto Serif TC', serif !important;
    font-weight: 700 !important;
    font-size: 0.95rem !important;
    color: var(--pagefind-ui-primary) !important;
  }
  
  .pagefind-ui__message {
    padding: 1rem !important;
    color: #64748b !important;
    text-align: center;
  }
</style>