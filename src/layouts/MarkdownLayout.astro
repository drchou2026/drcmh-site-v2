---
// src/layouts/MarkdownLayout.astro
import Layout from './Layout.astro';
import type { CollectionEntry } from 'astro:content';

interface Props {
  frontmatter: CollectionEntry<'blog'>['data'];
}

const { frontmatter } = Astro.props;

// ğŸŸ¢ 1. å®šç¾© advancedData çš„å‹åˆ¥çµæ§‹ï¼Œé¿å… TS å ±éŒ¯æ‰¾ä¸åˆ°å±¬æ€§
let advancedData: { excerpt?: string; seoTitle?: string; seoDescription?: string } = {};

// ğŸŸ¢ 2. ä½¿ç”¨ if åˆ¤æ–·ï¼šåªæœ‰ç•¶ discriminant ç‚º true æ™‚ï¼Œæ‰å»è®€å– value
if (frontmatter.advanced?.discriminant) {
  advancedData = frontmatter.advanced.value;
}

// ğŸŸ¢ 3. è¨­å®š SEO è®Šæ•¸ (å„ªå…ˆä½¿ç”¨é€²éšè¨­å®š > é è¨­å€¼)
const seoTitle = advancedData.seoTitle || frontmatter.title;
const seoDescription = advancedData.seoDescription || advancedData.excerpt;
---

<Layout 
  title={`${seoTitle} | å‘¨å­Ÿç¿°é†«å¸«`}
  description={seoDescription}
>
  <article class="py-24 bg-surface min-h-screen">
    {/* æ–‡ç«  Header */}
    <header class="container mx-auto px-4 max-w-4xl text-center mb-12">
      <div class="flex items-center justify-center gap-2 mb-6">
        {frontmatter.tags?.map(tag => (
          <span class="text-xs font-bold text-accent tracking-widest uppercase border border-accent/30 px-2 py-1 rounded">
            {tag}
          </span>
        ))}
      </div>
      
      <h1 class="text-3xl md:text-5xl font-serif font-bold text-primary leading-tight mb-6">
        {frontmatter.title}
      </h1>

      <div class="flex items-center justify-center gap-4 text-sm text-gray-500">
        <span>{new Date(frontmatter.date).toLocaleDateString('zh-TW')}</span>
        <span class="w-1 h-1 bg-gray-300 rounded-full"></span>
        <span>{frontmatter.author || 'å‘¨å­Ÿç¿° é†«å¸«'}</span>
      </div>
    </header>


    {/* å°é¢åœ– (è‹¥æœ‰) */}
    {/* {frontmatter.coverImage && (
      <div class="container mx-auto px-4 max-w-5xl mb-16">
        <Image src={frontmatter.coverImage} alt={frontmatter.title} class="w-full h-auto rounded-2xl shadow-lg" />
      </div>
    )} 
    */}

    {/* æ–‡ç« å…§å®¹ (Prose) */}
    <div class="container mx-auto px-4 max-w-3xl">
      <div class="prose prose-lg prose-slate mx-auto
        prose-headings:font-serif prose-headings:text-primary 
        prose-p:text-text prose-p:leading-loose
        prose-a:text-accent prose-a:no-underline hover:prose-a:underline
        prose-blockquote:border-l-accent prose-blockquote:bg-bg prose-blockquote:py-2 prose-blockquote:px-4 prose-blockquote:not-italic
        prose-li:text-text
        prose-img:rounded-xl prose-img:shadow-md
      ">
        <slot />
      </div>

      {/* æ–‡æœ« CTA */}
      <div class="mt-16 p-8 bg-highlight-gold/30 rounded-2xl border border-accent/20 text-center">
        <h3 class="text-xl font-serif font-bold text-primary mb-3">æœ‰ç›¸é—œå›°æ“¾å—ï¼Ÿ</h3>
        <p class="text-text mb-6">æ¯å€‹äººçš„ç‹€æ³ä¸ç›¡ç›¸åŒï¼Œå»ºè­°å¯¦éš›åˆ°è¨ºé–“é€²è¡Œè©•ä¼°ã€‚</p>
        <a href="/#clinic" class="inline-block bg-primary text-white px-8 py-3 rounded-full hover:bg-accent transition-colors shadow-lg hover:-translate-y-1">
          é ç´„é–€è¨ºè«®è©¢
        </a>
      </div>
    </div>
  </article>
</Layout>